@using Microsoft.AspNet.Identity
@using BugTracker.Models
@{
    ViewBag.Title = "Layout Notifications";
}

<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="~/images/icon.png">

    <title>Bug Tracker</title>

    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,400italic,700,800' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:300,200,100' rel='stylesheet' type='text/css'>

    <!-- Bootstrap core CSS -->
    <link href="~/js/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="~/js/jquery.gritter/css/jquery.gritter.css" />
    <link rel="stylesheet" href="~/fonts/font-awesome-4/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="~/js/jquery.nanoscroller/nanoscroller.css" />
    <link rel="stylesheet" type="text/css" href="~/js/jquery.codemirror/lib/codemirror.css">
    <link rel="stylesheet" type="text/css" href="~/js/jquery.codemirror/theme/ambiance.css">
    <link rel="stylesheet" type="text/css" href="~/js/jquery.vectormaps/jquery-jvectormap-1.2.2.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="~/js/jquery.datatables/bootstrap-adapter/css/datatables.css" />
    <link rel="stylesheet" type="text/css" href="~/js/jquery.icheck/skins/flat/green.css" />


    <link href="~/css/style.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../../assets/js/html5shiv.js"></script>
      <script src="../../assets/js/respond.min.js"></script>
    <![endif]-->

    <script charset="utf8" src="~/js/jquery.js"></script>
    @*<script type="text/javascript" charset="utf8" src="~/js/jquery-1.10.2.min.js"></script>*@

    <script type="text/javascript" src="~/js/jquery.cookie/jquery.cookie.js"></script>
    <script type="text/javascript" src="~/js/jquery.pushmenu/js/jPushMenu.js"></script>
    <script type="text/javascript" src="~/js/jquery.nanoscroller/jquery.nanoscroller.js"></script>
    <script type="text/javascript" src="~/js/jquery.sparkline/jquery.sparkline.min.js"></script>
    <script type="text/javascript" src="~/js/jquery.ui/jquery-ui.js"></script>
    <script type="text/javascript" src="~/js/jquery.gritter/js/jquery.gritter.js"></script>
    <script type="text/javascript" src="~/js/behaviour/core.js"></script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="~/js/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="~/js/jquery.codemirror/lib/codemirror.js"></script>
    <script type="text/javascript" src="~/js/jquery.codemirror/mode/xml/xml.js"></script>
    <script type="text/javascript" src="~/js/jquery.codemirror/mode/css/css.js"></script>
    <script type="text/javascript" src="~/js/jquery.codemirror/mode/htmlmixed/htmlmixed.js"></script>
    <script type="text/javascript" src="~/js/jquery.codemirror/addon/edit/matchbrackets.js"></script>
    <script type="text/javascript" src="~/js/jquery.vectormaps/jquery-jvectormap-1.2.2.min.js"></script>
    <script type="text/javascript" src="~/js/jquery.vectormaps/maps/jquery-jvectormap-world-mill-en.js"></script>
    <script type="text/javascript" src="~/js/behaviour/dashboard.js"></script>

    <script type="text/javascript" src="~/js/jquery.jeditable/jquery.jeditable.mini.js"></script>
    <script type="text/javascript" src="~/js/jquery.datatables/jquery.datatables.min.js"></script>
    <script type="text/javascript" src="~/js/jquery.datatables/bootstrap-adapter/js/datatables.js"></script>
    <link rel="stylesheet" type="text/css" href="~/js/jquery.niftymodals/css/component.css" />
    <script src="~/js/jquery.niftymodals/js/jquery.modalEffects.js"></script>

    @*<script type="text/javascript" src="~/js/bootstrap.multiselect/js/bootstrap-multiselect.js"></script>
        <script type="text/javascript" src="~/js/jquery.multiselect/js/jquery.multi-select.js"></script>
        <script type="text/javascript" src="~/js/jquery.quicksearch/jquery.quicksearch.js"></script>*@




</head>


<body class="animated">

    <!--****************** Sidebar Menu ************************-->

    <div id="cl-wrapper">

        <div class="cl-sidebar">
            <div class="cl-toggle"><i class="fa fa-bars"></i></div>
            <div class="cl-navblock">
                <div class="menu-space">
                    <div class="content">
                        <div class="sidebar-logo">
                            <div class="logo">
                                <a href="index2.html"></a>
                            </div>
                        </div>
                        @*<div class="side-user">
                                <div class="avatar"><img src="images/user-icon.png" alt="Avatar" /></div>
                                <div class="info">
                                    <p>40 <b>GB</b> / 100 <b>GB</b><span><a href="#"><i class="fa fa-plus"></i></a></span></p>
                                    <div class="progress progress-user">
                                        <div class="progress-bar" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%">
                                            <span class="sr-only">50% Complete (success)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>*@
                        <ul class="cl-vnavigation">
                            <li>
                                <a href="@Url.Action("Index", "Home")"><i class="fa fa-home"></i><span>Home</span></a>
                                <ul class="sub-menu">
                                    <li class="active"><a href="@Url.Action("Index", "Home")">User Home</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="@Url.Action("Index", "Tickets")"><i class="fa fa-bug"></i><span>Tickets</span></a>
                                <ul class="sub-menu">
                                    <li class="active"><a href="@Url.Action("Index", "Tickets")">All Tickets</a></li>
                                    <li class="active"><a href="@Url.Action("Create", "Tickets")">Create</a></li>
                                </ul>
                            </li>
                            @if (User.IsInRole("Admin") | User.IsInRole("Project Manager"))
                            {
                                <li>
                                    <a href="@Url.Action("Index", "Tickets")"><i class="fa fa-cogs"></i><span>Projects</span></a>
                                    <ul class="sub-menu">
                                        <li class="active"><a href="@Url.Action("Index", "Projects")">All Projects</a></li>
                                        <li class="active"><a href="@Url.Action("Create", "Projects")">Create Project</a></li>
                                        @*<li class="active"><a href="@Url.Action("AssignProjectsToUser", "Projects")">Assign Project To Users</a></li>
                                            <li class="active"><a href="@Url.Action("AssignUsersToProject", "Projects")">Assign Users To Project</a></li>*@
                                        <li class="active"><a href="@Url.Action("ListProjectsAndUsers", "Projects")">Projects and Users Table</a></li>
                                    </ul>
                                </li>
                            }
                            @if (User.IsInRole("Admin"))
                            {
                                <li>
                                    <a href="#"><i class="fa fa-user"></i><span>User Roles</span></a>
                                    <ul class="sub-menu">
                                        <li class="active"><a href="@Url.Action("ListUsers", "Roles")">Modify User Roles</a></li>
                                    </ul>
                                </li>
                            }
                            <li>
                                <a href="#"><i class="fa fa-comments-o"></i><span>User Notification</span></a>
                                <ul class="sub-menu">
                                    <li class="active"><a href="@Url.Action("Index", "TicketNotifications")">All Notifications</a></li>
                                </ul>
                            </li>


                        </ul>
                    </div>
                </div>
                <div class="text-right collapse-button" style="padding:7px 9px;">
                    <button id="sidebar-collapse" class="btn btn-default" style="" type="submit"><i style="color:#fff;" class="fa fa-angle-left"></i></button>
                    @using (Html.BeginForm("Search", "Tickets", FormMethod.Post, null))
                    {
                        @*<input class="form-control col-lg-12" type="text" name="searchStr" />*@
                        <input type="text" style="width:200px" class="form-control search" name="searchStr" placeholder="Search..." />
                        <button id="search" class="btn btn-default" style="" type="submit"><i style="color:#fff;" class="fa fa-search"></i></button>
                    }
                </div>
            </div>
        </div>




        <!--*********************************Top Bar ****************************************-->


        <div class="container-fluid" id="pcont">

            <div id="head-nav" class="navbar navbar-default">
                <div class="container-fluid">
                    <div class="navbar-collapse">
                        <ul class="nav navbar-nav navbar-right user-nav">
                            @* *************  Right Side Icon *************** *@
                            @if (Request.IsAuthenticated)
                            {
                                using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
                                {
                                    @Html.AntiForgeryToken()

                                    <li class="dropdown profile_menu">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><img alt="Avatar" src="~/images/user-icon.png" /><span>@User.Identity.GetUserName()</span> <b class="caret"></b></a>
                                        @*<a href="#" class="dropdown-toggle" data-toggle="dropdown"><img alt="Avatar" src="~/images/user-icon.png" /><span>@Html.Partial("_LoginPartial")</span> <b class="caret"></b></a>*@
                                        <ul class="dropdown-menu">
                                            <li><a href="@Url.Action("Index", "Manage")">My Account</a></li>
                                            <li class="divider"></li>
                                            <li><a href="javascript:document.getElementById('logoutForm').submit()">Sign Out</a></li>
                                        </ul>
                                    </li>
                                }
                            }
                            else
                            {
                                <li class="dropdown profile_menu">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><img alt="Avatar" src="~/images/user-icon.png" /><span>@User.Identity.GetUserName()</span> <b class="caret"></b></a>
                                    @*<a href="#" class="dropdown-toggle" data-toggle="dropdown"><img alt="Avatar" src="~/images/user-icon.png" /><span>@Html.Partial("_LoginPartial")</span> <b class="caret"></b></a>*@
                                    <ul class="dropdown-menu">
                                        <li><a href="@Url.Action("Login", "Account")">Sign In</a></li>
                                        <li class="divider"></li>
                                        <li><a href="@Url.Action("Register", "Account")">Register</a></li>
                                    </ul>
                                </li>
                            }
                        </ul>
                        <ul class="nav navbar-nav not-nav">

                            <li class="button dropdown">

                                <a href="@Url.Action("Index", "TicketNotifications")" dropdown-toggle" data-toggle="dropdown"><i class="fa fa-globe"></i><span class="bubble">@NotificationsStatic.GetUserNotificationsStatic(@User.Identity.GetUserId())</span></a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <div class="nano nscroller">
                                            <div class="content">
                                                <ul>
                                                    @{var tickets = NotificationsStatic.GetNewUserTickets(@User.Identity.GetUserId());
                                                    @*<li><a href="@Url.Action("Index", "TicketNotifications")"><i class="fa fa-bug warning"></i><b>Notifications : </b>All Notifications</a></li>*@
                                                        if (tickets != null)
                                                        {
                                                            if (tickets.Count() > 0)
                                                            {
                                                                <li><a href="@Url.Action("Details", "Tickets", new { id = @tickets[0].Id})"><i class="fa fa-bug danger"></i> <b>Ticket1</b> @tickets[0].Title <span class="date">@tickets[0].Created.ToString("MM/dd/yy")</span></a></li>
                                                            }
                                                            if (tickets.Count() > 1)
                                                            {
                                                                <li><a href="@Url.Action("Details", "Tickets", new { id = @tickets[1].Id})"><i class="fa fa-bug danger"></i> <b>Ticket2</b> @tickets[1].Title <span class="date">@tickets[1].Created.ToString("MM/dd/yy")</span></a></li>
                                                            }
                                                            if (tickets.Count() > 2)
                                                            {
                                                                <li><a href="@Url.Action("Details", "Tickets", new { id = @tickets[2].Id})"><i class="fa fa-bug danger"></i> <b>Ticket3</b> @tickets[2].Title <span class="date">@tickets[2].Created.ToString("MM/dd/yy")</span></a></li>
                                                            }
                                                        }
                                                    }
                                                </ul>
                                            </div>
                                        </div>
                                        <ul class="foot"><li><a href="@Url.Action("Index", "TicketNotifications")"><strong class="info"> View all Notifications </strong></a></li></ul>
                                    </li>
                                </ul>
                            </li>

                        </ul>

                    </div><!--/.nav-collapse animate-collapse -->
                </div>
            </div>




            <div class="cl-mcont">


                <!--Content-->
                @RenderBody()


            </div>
        </div>  <!--Container Fluid -->

    </div>  <!--Cl Wraper -->
    @*  FOllowing JQuery files interfere with Data Table JS files ?????? *@
    @*<script type="text/javascript" src="~/js/jquery.flot/jquery.flot.js"></script>
        <script type="text/javascript" src="~/js/jquery.flot/jquery.flot.pie.js"></script>
        <script type="text/javascript" src="~/js/jquery.flot/jquery.flot.resize.js"></script>
        <script type="text/javascript" src="~/js/jquery.flot/jquery.flot.labels.js"></script>*@



</body>

</html>
